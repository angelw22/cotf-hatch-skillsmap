{"ast":null,"code":"import _defineProperty from \"/Users/angel/Documents/skills_map/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/angel/Documents/skills_map/src/components/diagram.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport * as go from 'gojs';\nimport { ToolManager, Diagram } from 'gojs';\nimport { GojsDiagram, ModelChangeEventType } from 'react-gojs';\nimport DiagramButtons from './DiagramButtons';\nimport './MyDiagram.css';\nimport { getRandomColor } from '../utils/ColorHelper';\nimport SelectionDetails from './SelectionDetails';\n\nclass MyDiagram extends React.Component {\n  constructor(props) {\n    super(props);\n    this.nodeId = 0;\n    this.createDiagram = this.createDiagram.bind(this);\n    this.modelChangeHandler = this.modelChangeHandler.bind(this);\n    this.initModelHandler = this.initModelHandler.bind(this);\n    this.updateColorHandler = this.updateColorHandler.bind(this);\n    this.nodeSelectionHandler = this.nodeSelectionHandler.bind(this);\n    this.removeNode = this.removeNode.bind(this);\n    this.removeLink = this.removeLink.bind(this);\n    this.addNode = this.addNode.bind(this);\n    this.updateNodeText = this.updateNodeText.bind(this);\n    this.onTextEdited = this.onTextEdited.bind(this);\n    this.state = {\n      selectedNodeKeys: [],\n      model: {\n        nodeDataArray: [{\n          key: 'Alpha',\n          label: 'Alpha',\n          color: 'lightblue'\n        }],\n        linkDataArray: []\n      }\n    };\n  }\n\n  render() {\n    return [React.createElement(DiagramButtons, {\n      key: \"diagramButtons\",\n      onInit: this.initModelHandler,\n      onUpdateColor: this.updateColorHandler,\n      onAddNode: this.addNode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }), React.createElement(SelectionDetails, {\n      key: \"selectionDetails\",\n      selectedNodes: this.state.selectedNodeKeys,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }), React.createElement(GojsDiagram, {\n      diagramId: \"myDiagramDiv\",\n      model: this.props.model,\n      createDiagram: this.createDiagram,\n      className: \"myDiagram\",\n      onModelChange: this.modelChangedhandler,\n      updateDiagramProps: this.updateDiagramProps,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    })];\n  }\n\n  initModelHandler() {\n    this.setState(_objectSpread({}, this.state, {\n      model: {\n        nodeDataArray: [{\n          key: 'Alpha',\n          label: 'Alpha',\n          color: 'lightblue'\n        }, {\n          key: 'Beta',\n          label: 'Beta',\n          color: 'orange'\n        }, {\n          key: 'Gamma',\n          label: 'Gamma',\n          color: 'lightgreen'\n        }, {\n          key: 'Delta',\n          label: 'Delta',\n          color: 'pink'\n        }, {\n          key: 'Omega',\n          label: 'Omega',\n          color: 'grey'\n        }],\n        linkDataArray: [{\n          from: 'Alpha',\n          to: 'Beta'\n        }, {\n          from: 'Alpha',\n          to: 'Gamma'\n        }, {\n          from: 'Beta',\n          to: 'Delta'\n        }, {\n          from: 'Gamma',\n          to: 'Omega'\n        }]\n      }\n    }));\n  }\n\n  updateColorHandler() {\n    const updatedNodes = this.state.model.nodeDataArray.map(node => {\n      return _objectSpread({}, node, {\n        color: getRandomColor()\n      });\n    });\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: updatedNodes\n      })\n    }));\n  }\n\n  createDiagram(diagramId) {\n    const $ = go.GraphObject.make;\n    const myDiagram = $(go.Diagram, diagramId, {\n      initialContentAlignment: go.Spot.LeftCenter,\n      layout: $(go.TreeLayout, {\n        angle: 0,\n        arrangement: go.TreeLayout.ArrangementVertical,\n        treeStyle: go.TreeLayout.StyleLayered\n      }),\n      isReadOnly: false,\n      allowHorizontalScroll: true,\n      allowVerticalScroll: true,\n      allowZoom: false,\n      allowSelect: true,\n      autoScale: Diagram.Uniform,\n      contentAlignment: go.Spot.LeftCenter,\n      TextEdited: this.onTextEdited\n    });\n    myDiagram.toolManager.panningTool.isEnabled = false;\n    myDiagram.toolManager.mouseWheelBehavior = ToolManager.WheelScroll;\n    myDiagram.nodeTemplate = $(go.Node, 'Auto', {\n      selectionChanged: node => this.nodeSelectionHandler(node.key, node.isSelected)\n    }, $(go.Shape, 'RoundedRectangle', {\n      strokeWidth: 0\n    }, new go.Binding('fill', 'color')), $(go.TextBlock, {\n      margin: 8,\n      editable: true\n    }, new go.Binding('text', 'label')));\n    return myDiagram;\n  }\n\n  modelChangeHandler(event) {\n    switch (event.eventType) {\n      case ModelChangeEventType.Remove:\n        if (event.nodeData) {\n          this.removeNode(event.nodeData.key);\n        }\n\n        if (event.linkData) {\n          this.removeLink(event.linkData);\n        }\n\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  addNode() {\n    const newNodeId = 'node' + this.nodeId;\n    const linksToAdd = this.state.selectedNodeKeys.map(parent => {\n      return {\n        from: parent,\n        to: newNodeId\n      };\n    });\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray, {\n          key: newNodeId,\n          label: newNodeId,\n          color: getRandomColor()\n        }],\n        linkDataArray: linksToAdd.length > 0 ? [...this.state.model.linkDataArray].concat(linksToAdd) : [...this.state.model.linkDataArray]\n      })\n    }));\n    this.nodeId += 1;\n  }\n\n  removeNode(nodeKey) {\n    const nodeToRemoveIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n\n    if (nodeToRemoveIndex === -1) {\n      return;\n    }\n\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray.slice(0, nodeToRemoveIndex), ...this.state.model.nodeDataArray.slice(nodeToRemoveIndex + 1)]\n      })\n    }));\n  }\n\n  removeLink(linKToRemove) {\n    const linkToRemoveIndex = this.state.model.linkDataArray.findIndex(link => link.from === linKToRemove.from && link.to === linKToRemove.to);\n\n    if (linkToRemoveIndex === -1) {\n      return;\n    }\n\n    return _objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        linkDataArray: [...this.state.model.linkDataArray.slice(0, linkToRemoveIndex), ...this.state.model.linkDataArray.slice(linkToRemoveIndex + 1)]\n      })\n    });\n  }\n\n  updateNodeText(nodeKey, text) {\n    const nodeToUpdateIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n\n    if (nodeToUpdateIndex === -1) {\n      return;\n    }\n\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray.slice(0, nodeToUpdateIndex), _objectSpread({}, this.state.model.nodeDataArray[nodeToUpdateIndex], {\n          label: text\n        }), ...this.state.model.nodeDataArray.slice(nodeToUpdateIndex + 1)]\n      })\n    }));\n  }\n\n  nodeSelectionHandler(nodeKey, isSelected) {\n    if (isSelected) {\n      this.setState(_objectSpread({}, this.state, {\n        selectedNodeKeys: [...this.state.selectedNodeKeys, nodeKey]\n      }));\n    } else {\n      const nodeIndexToRemove = this.state.selectedNodeKeys.findIndex(key => key === nodeKey);\n\n      if (nodeIndexToRemove === -1) {\n        return;\n      }\n\n      this.setState(_objectSpread({}, this.state, {\n        selectedNodeKeys: [...this.state.selectedNodeKeys.slice(0, nodeIndexToRemove), ...this.state.selectedNodeKeys.slice(nodeIndexToRemove + 1)]\n      }));\n    }\n  }\n\n  onTextEdited(e) {\n    const tb = e.subject;\n\n    if (tb === null) {\n      return;\n    }\n\n    const node = tb.part;\n\n    if (node instanceof go.Node) {\n      this.updateNodeText(node.key, tb.text);\n    }\n  }\n\n}\n\nexport default MyDiagram;","map":{"version":3,"sources":["/Users/angel/Documents/skills_map/src/components/diagram.js"],"names":["React","go","ToolManager","Diagram","GojsDiagram","ModelChangeEventType","DiagramButtons","getRandomColor","SelectionDetails","MyDiagram","Component","constructor","props","nodeId","createDiagram","bind","modelChangeHandler","initModelHandler","updateColorHandler","nodeSelectionHandler","removeNode","removeLink","addNode","updateNodeText","onTextEdited","state","selectedNodeKeys","model","nodeDataArray","key","label","color","linkDataArray","render","modelChangedhandler","updateDiagramProps","setState","from","to","updatedNodes","map","node","diagramId","$","GraphObject","make","myDiagram","initialContentAlignment","Spot","LeftCenter","layout","TreeLayout","angle","arrangement","ArrangementVertical","treeStyle","StyleLayered","isReadOnly","allowHorizontalScroll","allowVerticalScroll","allowZoom","allowSelect","autoScale","Uniform","contentAlignment","TextEdited","toolManager","panningTool","isEnabled","mouseWheelBehavior","WheelScroll","nodeTemplate","Node","selectionChanged","isSelected","Shape","strokeWidth","Binding","TextBlock","margin","editable","event","eventType","Remove","nodeData","linkData","newNodeId","linksToAdd","parent","length","concat","nodeKey","nodeToRemoveIndex","findIndex","slice","linKToRemove","linkToRemoveIndex","link","text","nodeToUpdateIndex","nodeIndexToRemove","e","tb","subject","part"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as go from 'gojs';\nimport { ToolManager, Diagram } from 'gojs';\nimport { GojsDiagram, ModelChangeEventType } from 'react-gojs';\nimport DiagramButtons from './DiagramButtons';\nimport './MyDiagram.css';\nimport { getRandomColor } from '../utils/ColorHelper';\nimport SelectionDetails from './SelectionDetails';\n\nclass MyDiagram extends React.Component {\n    nodeId = 0;\n\n    constructor(props) {\n        super(props);\n        this.createDiagram = this.createDiagram.bind(this);\n        this.modelChangeHandler = this.modelChangeHandler.bind(this);\n        this.initModelHandler = this.initModelHandler.bind(this);\n        this.updateColorHandler = this.updateColorHandler.bind(this);\n        this.nodeSelectionHandler = this.nodeSelectionHandler.bind(this);\n        this.removeNode = this.removeNode.bind(this);\n        this.removeLink = this.removeLink.bind(this);\n        this.addNode = this.addNode.bind(this);\n        this.updateNodeText = this.updateNodeText.bind(this);\n        this.onTextEdited = this.onTextEdited.bind(this);\n        this.state = {\n            selectedNodeKeys: [],\n            model: {\n                nodeDataArray: [{ key: 'Alpha', label: 'Alpha', color: 'lightblue' }],\n                linkDataArray: []\n            }\n        };\n    }\n\n    render() {\n        return [\n            <DiagramButtons\n                key=\"diagramButtons\"\n                onInit={this.initModelHandler}\n                onUpdateColor={this.updateColorHandler}\n                onAddNode={this.addNode}\n            />,\n            <SelectionDetails key=\"selectionDetails\" selectedNodes={this.state.selectedNodeKeys} />,\n            <GojsDiagram\n    diagramId=\"myDiagramDiv\"\n    model={this.props.model}\n    createDiagram={this.createDiagram}\n    className=\"myDiagram\"\n    onModelChange={this.modelChangedhandler}\n    updateDiagramProps={this.updateDiagramProps}\n/>\n        ];\n    }\n\n    initModelHandler() {\n        this.setState({\n            ...this.state,\n            model: {\n                nodeDataArray: [\n                    { key: 'Alpha', label: 'Alpha', color: 'lightblue' },\n                    { key: 'Beta', label: 'Beta', color: 'orange' },\n                    { key: 'Gamma', label: 'Gamma', color: 'lightgreen' },\n                    { key: 'Delta', label: 'Delta', color: 'pink' },\n                    { key: 'Omega', label: 'Omega', color: 'grey' }\n                ],\n                linkDataArray: [\n                    { from: 'Alpha', to: 'Beta' },\n                    { from: 'Alpha', to: 'Gamma' },\n                    { from: 'Beta', to: 'Delta' },\n                    { from: 'Gamma', to: 'Omega' }\n                ]\n            }\n        });\n    }\n\n    updateColorHandler() {\n        const updatedNodes = this.state.model.nodeDataArray.map(node => {\n            return {\n                ...node,\n                color: getRandomColor()\n            };\n        });\n\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: updatedNodes\n            }\n        });\n    }\n\n    createDiagram(diagramId: string) {\n        const $ = go.GraphObject.make;\n\n        const myDiagram = $(go.Diagram, diagramId, {\n            initialContentAlignment: go.Spot.LeftCenter,\n            layout: $(go.TreeLayout, {\n                angle: 0,\n                arrangement: go.TreeLayout.ArrangementVertical,\n                treeStyle: go.TreeLayout.StyleLayered\n            }),\n            isReadOnly: false,\n            allowHorizontalScroll: true,\n            allowVerticalScroll: true,\n            allowZoom: false,\n            allowSelect: true,\n            autoScale: Diagram.Uniform,\n            contentAlignment: go.Spot.LeftCenter,\n            TextEdited: this.onTextEdited\n        });\n\n        myDiagram.toolManager.panningTool.isEnabled = false;\n        myDiagram.toolManager.mouseWheelBehavior = ToolManager.WheelScroll;\n\n        myDiagram.nodeTemplate = $(\n            go.Node,\n            'Auto',\n            {\n                selectionChanged: node => this.nodeSelectionHandler(node.key, node.isSelected)\n            },\n            $(go.Shape, 'RoundedRectangle', { strokeWidth: 0 }, new go.Binding('fill', 'color')),\n            $(go.TextBlock, { margin: 8, editable: true }, new go.Binding('text', 'label'))\n        );\n\n        return myDiagram;\n    }\n\n    modelChangeHandler(event) {\n        switch (event.eventType) {\n            case ModelChangeEventType.Remove:\n                if (event.nodeData) {\n                    this.removeNode(event.nodeData.key);\n                }\n                if (event.linkData) {\n                    this.removeLink(event.linkData);\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    addNode() {\n        const newNodeId = 'node' + this.nodeId;\n        const linksToAdd = this.state.selectedNodeKeys.map(parent => {\n            return { from: parent, to: newNodeId };\n        });\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray,\n                    { key: newNodeId, label: newNodeId, color: getRandomColor() }\n                ],\n                linkDataArray:\n                    linksToAdd.length > 0\n                        ? [...this.state.model.linkDataArray].concat(linksToAdd)\n                        : [...this.state.model.linkDataArray]\n            }\n        });\n        this.nodeId += 1;\n    }\n\n    removeNode(nodeKey) {\n        const nodeToRemoveIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n        if (nodeToRemoveIndex === -1) {\n            return;\n        }\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray.slice(0, nodeToRemoveIndex),\n                    ...this.state.model.nodeDataArray.slice(nodeToRemoveIndex + 1)\n                ]\n            }\n        });\n    }\n\n    removeLink(linKToRemove) {\n        const linkToRemoveIndex = this.state.model.linkDataArray.findIndex(\n            link => link.from === linKToRemove.from && link.to === linKToRemove.to\n        );\n        if (linkToRemoveIndex === -1) {\n            return;\n        }\n        return {\n            ...this.state,\n            model: {\n                ...this.state.model,\n                linkDataArray: [\n                    ...this.state.model.linkDataArray.slice(0, linkToRemoveIndex),\n                    ...this.state.model.linkDataArray.slice(linkToRemoveIndex + 1)\n                ]\n            }\n        };\n    }\n\n    updateNodeText(nodeKey, text) {\n        const nodeToUpdateIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n        if (nodeToUpdateIndex === -1) {\n            return;\n        }\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray.slice(0, nodeToUpdateIndex),\n                    {\n                        ...this.state.model.nodeDataArray[nodeToUpdateIndex],\n                        label: text\n                    },\n                    ...this.state.model.nodeDataArray.slice(nodeToUpdateIndex + 1)\n                ]\n            }\n        });\n    }\n\n    nodeSelectionHandler(nodeKey, isSelected) {\n        if (isSelected) {\n            this.setState({\n                ...this.state,\n                selectedNodeKeys: [...this.state.selectedNodeKeys, nodeKey]\n            });\n        } else {\n            const nodeIndexToRemove = this.state.selectedNodeKeys.findIndex(key => key === nodeKey);\n            if (nodeIndexToRemove === -1) {\n                return;\n            }\n            this.setState({\n                ...this.state,\n                selectedNodeKeys: [\n                    ...this.state.selectedNodeKeys.slice(0, nodeIndexToRemove),\n                    ...this.state.selectedNodeKeys.slice(nodeIndexToRemove + 1)\n                ]\n            });\n        }\n    }\n\n    onTextEdited(e) {\n        const tb = e.subject;\n        if (tb === null) {\n            return;\n        }\n        const node = tb.part;\n        if (node instanceof go.Node) {\n            this.updateNodeText(node.key, tb.text);\n        }\n    }\n}\n\nexport default MyDiagram;\n"]},"metadata":{},"sourceType":"module"}