{"ast":null,"code":"import _defineProperty from \"/Users/angel/Documents/skills_map/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/angel/Documents/skills_map/src/components/diagram.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport * as go from 'gojs';\nimport { ToolManager, Diagram } from 'gojs';\nimport { GojsDiagram, ModelChangeEventType } from 'react-gojs';\nimport DiagramButtons from './DiagramButtons';\nimport './MyDiagram.css';\nimport { getRandomColor } from '../utils/ColorHelper';\nimport SelectionDetails from './SelectionDetails';\n\nclass MyDiagram extends React.Component {\n  constructor(props) {\n    super(props);\n    this.nodeId = 0;\n\n    this.createDiagram = diagramId => {\n      const $ = go.GraphObject.make;\n      const myDiagram = $(go.Diagram, diagramId, {\n        initialContentAlignment: go.Spot.LeftCenter,\n        layout: $(go.TreeLayout, {\n          angle: 0,\n          arrangement: go.TreeLayout.ArrangementVertical,\n          treeStyle: go.TreeLayout.StyleLayered\n        }),\n        isReadOnly: false,\n        allowHorizontalScroll: true,\n        allowVerticalScroll: true,\n        allowZoom: false,\n        allowSelect: true,\n        autoScale: Diagram.Uniform,\n        contentAlignment: go.Spot.LeftCenter,\n        TextEdited: this.onTextEdited\n      });\n      myDiagram.toolManager.panningTool.isEnabled = false;\n      myDiagram.toolManager.mouseWheelBehavior = ToolManager.WheelScroll;\n      myDiagram.nodeTemplate = $(go.Node, 'Auto', {\n        selectionChanged: node => this.nodeSelectionHandler(node.key, node.isSelected)\n      }, $(go.Shape, 'RoundedRectangle', {\n        strokeWidth: 0\n      }, new go.Binding('fill', 'color')), $(go.TextBlock, {\n        margin: 8,\n        editable: true\n      }, new go.Binding('text', 'label')));\n      return myDiagram;\n    };\n\n    this.createDiagram = this.createDiagram.bind(this);\n    this.modelChangeHandler = this.modelChangeHandler.bind(this);\n    this.initModelHandler = this.initModelHandler.bind(this);\n    this.updateColorHandler = this.updateColorHandler.bind(this);\n    this.nodeSelectionHandler = this.nodeSelectionHandler.bind(this);\n    this.removeNode = this.removeNode.bind(this);\n    this.removeLink = this.removeLink.bind(this);\n    this.addNode = this.addNode.bind(this);\n    this.updateNodeText = this.updateNodeText.bind(this);\n    this.onTextEdited = this.onTextEdited.bind(this);\n    this.state = {\n      selectedNodeKeys: [],\n      model: {\n        nodeDataArray: [{\n          key: 'Alpha',\n          label: 'Alpha',\n          color: 'lightblue'\n        }],\n        linkDataArray: []\n      }\n    };\n  }\n\n  render() {\n    return [React.createElement(DiagramButtons, {\n      key: \"diagramButtons\",\n      onInit: this.initModelHandler,\n      onUpdateColor: this.updateColorHandler,\n      onAddNode: this.addNode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }), React.createElement(SelectionDetails, {\n      key: \"selectionDetails\",\n      selectedNodes: this.state.selectedNodeKeys,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }), React.createElement(GojsDiagram, {\n      key: \"gojsDiagram\",\n      diagramId: \"myDiagramDiv\",\n      model: this.state.model,\n      createDiagram: this.createDiagram,\n      className: \"myDiagram\",\n      onModelChange: this.modelChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    })];\n  }\n\n  initModelHandler() {\n    this.setState(_objectSpread({}, this.state, {\n      model: {\n        nodeDataArray: [{\n          key: 'Alpha',\n          label: 'Alpha',\n          color: 'lightblue'\n        }, {\n          key: 'Beta',\n          label: 'Beta',\n          color: 'orange'\n        }, {\n          key: 'Gamma',\n          label: 'Gamma',\n          color: 'lightgreen'\n        }, {\n          key: 'Delta',\n          label: 'Delta',\n          color: 'pink'\n        }, {\n          key: 'Omega',\n          label: 'Omega',\n          color: 'grey'\n        }],\n        linkDataArray: [{\n          from: 'Alpha',\n          to: 'Beta'\n        }, {\n          from: 'Alpha',\n          to: 'Gamma'\n        }, {\n          from: 'Beta',\n          to: 'Delta'\n        }, {\n          from: 'Gamma',\n          to: 'Omega'\n        }]\n      }\n    }));\n  }\n\n  updateColorHandler() {\n    const updatedNodes = this.state.model.nodeDataArray.map(node => {\n      return _objectSpread({}, node, {\n        color: getRandomColor()\n      });\n    });\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: updatedNodes\n      })\n    }));\n  }\n\n  modelChangeHandler(event) {\n    switch (event.eventType) {\n      case ModelChangeEventType.Remove:\n        if (event.nodeData) {\n          this.removeNode(event.nodeData.key);\n        }\n\n        if (event.linkData) {\n          this.removeLink(event.linkData);\n        }\n\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  addNode() {\n    const newNodeId = 'node' + this.nodeId;\n    const linksToAdd = this.state.selectedNodeKeys.map(parent => {\n      return {\n        from: parent,\n        to: newNodeId\n      };\n    });\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray, {\n          key: newNodeId,\n          label: newNodeId,\n          color: getRandomColor()\n        }],\n        linkDataArray: linksToAdd.length > 0 ? [...this.state.model.linkDataArray].concat(linksToAdd) : [...this.state.model.linkDataArray]\n      })\n    }));\n    this.nodeId += 1;\n  }\n\n  removeNode(nodeKey) {\n    const nodeToRemoveIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n\n    if (nodeToRemoveIndex === -1) {\n      return;\n    }\n\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray.slice(0, nodeToRemoveIndex), ...this.state.model.nodeDataArray.slice(nodeToRemoveIndex + 1)]\n      })\n    }));\n  }\n\n  removeLink(linKToRemove) {\n    const linkToRemoveIndex = this.state.model.linkDataArray.findIndex(link => link.from === linKToRemove.from && link.to === linKToRemove.to);\n\n    if (linkToRemoveIndex === -1) {\n      return;\n    }\n\n    return _objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        linkDataArray: [...this.state.model.linkDataArray.slice(0, linkToRemoveIndex), ...this.state.model.linkDataArray.slice(linkToRemoveIndex + 1)]\n      })\n    });\n  }\n\n  updateNodeText(nodeKey, text) {\n    const nodeToUpdateIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n\n    if (nodeToUpdateIndex === -1) {\n      return;\n    }\n\n    this.setState(_objectSpread({}, this.state, {\n      model: _objectSpread({}, this.state.model, {\n        nodeDataArray: [...this.state.model.nodeDataArray.slice(0, nodeToUpdateIndex), _objectSpread({}, this.state.model.nodeDataArray[nodeToUpdateIndex], {\n          label: text\n        }), ...this.state.model.nodeDataArray.slice(nodeToUpdateIndex + 1)]\n      })\n    }));\n  }\n\n  nodeSelectionHandler(nodeKey, isSelected) {\n    if (isSelected) {\n      this.setState(_objectSpread({}, this.state, {\n        selectedNodeKeys: [...this.state.selectedNodeKeys, nodeKey]\n      }));\n    } else {\n      const nodeIndexToRemove = this.state.selectedNodeKeys.findIndex(key => key === nodeKey);\n\n      if (nodeIndexToRemove === -1) {\n        return;\n      }\n\n      this.setState(_objectSpread({}, this.state, {\n        selectedNodeKeys: [...this.state.selectedNodeKeys.slice(0, nodeIndexToRemove), ...this.state.selectedNodeKeys.slice(nodeIndexToRemove + 1)]\n      }));\n    }\n  }\n\n  onTextEdited(e) {\n    const tb = e.subject;\n\n    if (tb === null) {\n      return;\n    }\n\n    const node = tb.part;\n\n    if (node instanceof go.Node) {\n      this.updateNodeText(node.key, tb.text);\n    }\n  }\n\n}\n\nexport default MyDiagram;","map":{"version":3,"sources":["/Users/angel/Documents/skills_map/src/components/diagram.js"],"names":["React","go","ToolManager","Diagram","GojsDiagram","ModelChangeEventType","DiagramButtons","getRandomColor","SelectionDetails","MyDiagram","Component","constructor","props","nodeId","createDiagram","diagramId","$","GraphObject","make","myDiagram","initialContentAlignment","Spot","LeftCenter","layout","TreeLayout","angle","arrangement","ArrangementVertical","treeStyle","StyleLayered","isReadOnly","allowHorizontalScroll","allowVerticalScroll","allowZoom","allowSelect","autoScale","Uniform","contentAlignment","TextEdited","onTextEdited","toolManager","panningTool","isEnabled","mouseWheelBehavior","WheelScroll","nodeTemplate","Node","selectionChanged","node","nodeSelectionHandler","key","isSelected","Shape","strokeWidth","Binding","TextBlock","margin","editable","bind","modelChangeHandler","initModelHandler","updateColorHandler","removeNode","removeLink","addNode","updateNodeText","state","selectedNodeKeys","model","nodeDataArray","label","color","linkDataArray","render","setState","from","to","updatedNodes","map","event","eventType","Remove","nodeData","linkData","newNodeId","linksToAdd","parent","length","concat","nodeKey","nodeToRemoveIndex","findIndex","slice","linKToRemove","linkToRemoveIndex","link","text","nodeToUpdateIndex","nodeIndexToRemove","e","tb","subject","part"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as go from 'gojs';\nimport { ToolManager, Diagram } from 'gojs';\nimport { GojsDiagram, ModelChangeEventType } from 'react-gojs';\nimport DiagramButtons from './DiagramButtons';\nimport './MyDiagram.css';\nimport { getRandomColor } from '../utils/ColorHelper';\nimport SelectionDetails from './SelectionDetails';\n\nclass MyDiagram extends React.Component {\n    nodeId = 0;\n\n    constructor(props) {\n        super(props);\n        this.createDiagram = this.createDiagram.bind(this);\n        this.modelChangeHandler = this.modelChangeHandler.bind(this);\n        this.initModelHandler = this.initModelHandler.bind(this);\n        this.updateColorHandler = this.updateColorHandler.bind(this);\n        this.nodeSelectionHandler = this.nodeSelectionHandler.bind(this);\n        this.removeNode = this.removeNode.bind(this);\n        this.removeLink = this.removeLink.bind(this);\n        this.addNode = this.addNode.bind(this);\n        this.updateNodeText = this.updateNodeText.bind(this);\n        this.onTextEdited = this.onTextEdited.bind(this);\n        this.state = {\n            selectedNodeKeys: [],\n            model: {\n                nodeDataArray: [{ key: 'Alpha', label: 'Alpha', color: 'lightblue' }],\n                linkDataArray: []\n            }\n        };\n    }\n\n    render() {\n        return [\n            <DiagramButtons\n                key=\"diagramButtons\"\n                onInit={this.initModelHandler}\n                onUpdateColor={this.updateColorHandler}\n                onAddNode={this.addNode}\n            />,\n            <SelectionDetails key=\"selectionDetails\" selectedNodes={this.state.selectedNodeKeys} />,\n            <GojsDiagram\n                key=\"gojsDiagram\"\n                diagramId=\"myDiagramDiv\"\n                model={this.state.model}\n                createDiagram={this.createDiagram}\n                className=\"myDiagram\"\n                onModelChange={this.modelChangeHandler}\n            />\n        ];\n    }\n\n    initModelHandler() {\n        this.setState({\n            ...this.state,\n            model: {\n                nodeDataArray: [\n                    { key: 'Alpha', label: 'Alpha', color: 'lightblue' },\n                    { key: 'Beta', label: 'Beta', color: 'orange' },\n                    { key: 'Gamma', label: 'Gamma', color: 'lightgreen' },\n                    { key: 'Delta', label: 'Delta', color: 'pink' },\n                    { key: 'Omega', label: 'Omega', color: 'grey' }\n                ],\n                linkDataArray: [\n                    { from: 'Alpha', to: 'Beta' },\n                    { from: 'Alpha', to: 'Gamma' },\n                    { from: 'Beta', to: 'Delta' },\n                    { from: 'Gamma', to: 'Omega' }\n                ]\n            }\n        });\n    }\n\n    updateColorHandler() {\n        const updatedNodes = this.state.model.nodeDataArray.map(node => {\n            return {\n                ...node,\n                color: getRandomColor()\n            };\n        });\n\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: updatedNodes\n            }\n        });\n    }\n\n    createDiagram = diagramId => {\n        const $ = go.GraphObject.make;\n\n        const myDiagram = $(go.Diagram, diagramId, {\n            initialContentAlignment: go.Spot.LeftCenter,\n            layout: $(go.TreeLayout, {\n                angle: 0,\n                arrangement: go.TreeLayout.ArrangementVertical,\n                treeStyle: go.TreeLayout.StyleLayered\n            }),\n            isReadOnly: false,\n            allowHorizontalScroll: true,\n            allowVerticalScroll: true,\n            allowZoom: false,\n            allowSelect: true,\n            autoScale: Diagram.Uniform,\n            contentAlignment: go.Spot.LeftCenter,\n            TextEdited: this.onTextEdited\n        });\n\n        myDiagram.toolManager.panningTool.isEnabled = false;\n        myDiagram.toolManager.mouseWheelBehavior = ToolManager.WheelScroll;\n\n        myDiagram.nodeTemplate = $(\n            go.Node,\n            'Auto',\n            {\n                selectionChanged: node => this.nodeSelectionHandler(node.key, node.isSelected)\n            },\n            $(go.Shape, 'RoundedRectangle', { strokeWidth: 0 }, new go.Binding('fill', 'color')),\n            $(go.TextBlock, { margin: 8, editable: true }, new go.Binding('text', 'label'))\n        );\n\n        return myDiagram;\n    }\n\n    modelChangeHandler(event) {\n        switch (event.eventType) {\n            case ModelChangeEventType.Remove:\n                if (event.nodeData) {\n                    this.removeNode(event.nodeData.key);\n                }\n                if (event.linkData) {\n                    this.removeLink(event.linkData);\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    addNode() {\n        const newNodeId = 'node' + this.nodeId;\n        const linksToAdd = this.state.selectedNodeKeys.map(parent => {\n            return { from: parent, to: newNodeId };\n        });\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray,\n                    { key: newNodeId, label: newNodeId, color: getRandomColor() }\n                ],\n                linkDataArray:\n                    linksToAdd.length > 0\n                        ? [...this.state.model.linkDataArray].concat(linksToAdd)\n                        : [...this.state.model.linkDataArray]\n            }\n        });\n        this.nodeId += 1;\n    }\n\n    removeNode(nodeKey) {\n        const nodeToRemoveIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n        if (nodeToRemoveIndex === -1) {\n            return;\n        }\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray.slice(0, nodeToRemoveIndex),\n                    ...this.state.model.nodeDataArray.slice(nodeToRemoveIndex + 1)\n                ]\n            }\n        });\n    }\n\n    removeLink(linKToRemove) {\n        const linkToRemoveIndex = this.state.model.linkDataArray.findIndex(\n            link => link.from === linKToRemove.from && link.to === linKToRemove.to\n        );\n        if (linkToRemoveIndex === -1) {\n            return;\n        }\n        return {\n            ...this.state,\n            model: {\n                ...this.state.model,\n                linkDataArray: [\n                    ...this.state.model.linkDataArray.slice(0, linkToRemoveIndex),\n                    ...this.state.model.linkDataArray.slice(linkToRemoveIndex + 1)\n                ]\n            }\n        };\n    }\n\n    updateNodeText(nodeKey, text) {\n        const nodeToUpdateIndex = this.state.model.nodeDataArray.findIndex(node => node.key === nodeKey);\n        if (nodeToUpdateIndex === -1) {\n            return;\n        }\n        this.setState({\n            ...this.state,\n            model: {\n                ...this.state.model,\n                nodeDataArray: [\n                    ...this.state.model.nodeDataArray.slice(0, nodeToUpdateIndex),\n                    {\n                        ...this.state.model.nodeDataArray[nodeToUpdateIndex],\n                        label: text\n                    },\n                    ...this.state.model.nodeDataArray.slice(nodeToUpdateIndex + 1)\n                ]\n            }\n        });\n    }\n\n    nodeSelectionHandler(nodeKey, isSelected) {\n        if (isSelected) {\n            this.setState({\n                ...this.state,\n                selectedNodeKeys: [...this.state.selectedNodeKeys, nodeKey]\n            });\n        } else {\n            const nodeIndexToRemove = this.state.selectedNodeKeys.findIndex(key => key === nodeKey);\n            if (nodeIndexToRemove === -1) {\n                return;\n            }\n            this.setState({\n                ...this.state,\n                selectedNodeKeys: [\n                    ...this.state.selectedNodeKeys.slice(0, nodeIndexToRemove),\n                    ...this.state.selectedNodeKeys.slice(nodeIndexToRemove + 1)\n                ]\n            });\n        }\n    }\n\n    onTextEdited(e) {\n        const tb = e.subject;\n        if (tb === null) {\n            return;\n        }\n        const node = tb.part;\n        if (node instanceof go.Node) {\n            this.updateNodeText(node.key, tb.text);\n        }\n    }\n}\n\nexport default MyDiagram;\n"]},"metadata":{},"sourceType":"module"}